var app=getApp();function noop(){}function upload(a){var b=a.file,c=a.success||noop,d=a.fail||noop;getUploadToken({success(f){wx.uploadFile({url:'https://upload.qbox.me/',filePath:b,name:'file',formData:{token:f,'x:skip_save':1},success:g=>{try{g=JSON.parse(g.data)}catch(h){d({type:'yz:uploadFile',code:-99999,msg:'JSON\u89E3\u6790\u9519\u8BEF'})}0==+g.code?c(g.data):d({type:'yz:uploadFile',code:g.code,msg:g.msg})},fail:g=>{d({type:'wx:uploadFile',code:-99999,msg:g.errMsg})}})},fail(f){d(f)}})}function getUploadToken(a){var b=a.success||noop,c=a.fail||noop;app.carmen({api:'weapp.wsc.picture.uploadtoken/1.0.0/get',query:{scope_id:0},success:d=>{b(d.upload_token)},fail:d=>{c(d)}})}module.exports=upload;