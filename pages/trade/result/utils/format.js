var config=require('../data/order'),each=require('../../../../utils/each'),money=require('../../../../utils/money'),cdnImage=require('../../../../utils/cdnImage');module.exports={getOrderData(a){var b=!1;a.items.forEach(j=>{var k=j.goods_info||{};b=b||0<k.is_virtual}),a.isVirtual=b;var c=a.state,d=config.getSteps(c);a.steps=d;var e=0;a.items.forEach(j=>{j.image_url=cdnImage(j.image_url,'!200x200.jpg');var k='';j.sku.forEach(m=>{k+=m.v+' '}),j.skuStr=k;var l=[];each(j.message,(m,n)=>{l.push({name:n,value:m})}),j.message=l,e+=100*j.item_total_price}),a.totalPriceStr=money(e).toYuan(),a.isFreePostage=0==parseFloat(a.postage);var f=a.preferences.order.coupons.money||{},g=f.card||f.code||{};g.discountFee=money(g.used_value).toYuan(),a.couponData=g;var h=a.preferences.order.reduce||[],i=h[0]||{};return i.discountFee=money(i.discount_fee).toYuan(),a.reduceData=i,a},parseSafeData(a,b){var c=b.items||[];return c.forEach(d=>{each(a,(e,f)=>{f==d.item_id&&(d.safe={show:1==e.showType,text:e.showText,safe_no:e.safeNo})})}),b},getMessagePageData(a){return a.payPriceStr=a.pay_price,a.imgUrl=a.image_url,a}};